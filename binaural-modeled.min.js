!function t(e,i,n){function s(r,a){if(!i[r]){if(!e[r]){var h="function"==typeof require&&require;if(!a&&h)return h(r,!0);if(o)return o(r,!0);var f=new Error("Cannot find module '"+r+"'");throw f.code="MODULE_NOT_FOUND",f}var u=i[r]={exports:{}};e[r][0].call(u.exports,function(t){var i=e[r][1][t];return s(i?i:t)},u,u.exports,t,e,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(t,e,i){e.exports={BinauralModeled:t("./dist/binaural-modeled")}},{"./dist/binaural-modeled":2}],2:[function(t,e,i){"use strict";var n=t("babel-runtime/helpers/create-class")["default"],s=t("babel-runtime/helpers/class-call-check")["default"],o=t("kdt"),r=t("biquad-filter"),a=t("fractional-delay"),h=function(){function t(e){s(this,t),this.audioContext=e.audioContext,this.hrtfDataset=void 0,this.hrtfDatasetLength=void 0,this.nextPosition=[],this.changeWhenFinishCrossfading=!1,this.position=[],this.crossfadeDuration=.02,this.bufferSize=1024,this.tree=-1,this.input=this.audioContext.createGain(),this.mainAudioGraph=new f({audioContext:this.audioContext}),this.mainAudioGraph.gain.value=1,this.input.connect(this.mainAudioGraph.input),this.secondaryAudioGraph=new f({audioContext:this.audioContext}),this.secondaryAudioGraph.gain.value=0,this.input.connect(this.secondaryAudioGraph.input),this.sampleRate=this.audioContext.sampleRate,this.input.connect(this.mainAudioGraph.input),this.input.connect(this.secondaryAudioGraph.input)}return n(t,[{key:"connect",value:function(t){return this.mainAudioGraph.connect(t),this.secondaryAudioGraph.connect(t),this}},{key:"disconnect",value:function(t){return this.mainAudioGraph.disconnect(t),this.secondaryAudioGraph.disconnect(t),this}},{key:"distance",value:function(t,e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)+Math.pow(t.z-e.z,2)}},{key:"setLastPosition",value:function(){this.isCrossfading()||(this.changeWhenFinishCrossfading=!1,clearInterval(this.intervalID),this.reallyStartPosition())}},{key:"crossfading",value:function(){var t=this.audioContext.currentTime;this.mainAudioGraph.gain.setValueAtTime(1,t+2*this.bufferSize/this.sampleRate),this.mainAudioGraph.gain.linearRampToValueAtTime(0,t+this.crossfadeDuration+2*this.bufferSize/this.sampleRate),this.secondaryAudioGraph.gain.setValueAtTime(0,t+2*this.bufferSize/this.sampleRate),this.secondaryAudioGraph.gain.linearRampToValueAtTime(1,t+this.crossfadeDuration+2*this.bufferSize/this.sampleRate)}},{key:"setPosition",value:function(t,e,i){if(3===arguments.length){var n=this.getRealCoordinates(t,e,i);if(n.azimuth!==this.position.azimuth||n.elevation!==this.position.elevation||n.distance!==this.position.distance)return this.isCrossfading()===!0?(this.changeWhenFinishCrossfading===!0?clearInterval(this.intervalID):this.changeWhenFinishCrossfading=!0,this.nextPosition.azimuth=n.azimuth,this.nextPosition.elevation=n.elevation,this.nextPosition.distance=n.distance,this.intervalID=window.setInterval(this.setLastPosition.bind(this),.005)):(this.nextPosition.azimuth=n.azimuth,this.nextPosition.elevation=n.elevation,this.nextPosition.distance=n.distance,this.reallyStartPosition()),this}}},{key:"reallyStartPosition",value:function(){this.position.azimuth=this.nextPosition.azimuth,this.position.elevation=this.nextPosition.elevation,this.position.distance=this.nextPosition.distance;var t=this.getHRTF(this.position.azimuth,this.position.elevation,this.position.distance);this.secondaryAudioGraph.setCoefficients(t.iir_coeffs_left,t.iir_coeffs_right),this.secondaryAudioGraph.setDelay(t.itd/1e3),this.crossfading();var e=this.mainAudioGraph;this.mainAudioGraph=this.secondaryAudioGraph,this.secondaryAudioGraph=e}},{key:"getPosition",value:function(){return this.position}},{key:"setCrossfadeDuration",value:function(t){this.crossfadeDuration=t/1e3}},{key:"getCrossfadeDuration",value:function(){return 1e3*this.crossfadeDuration}},{key:"isCrossfading",value:function(){return 1!==this.mainAudioGraph.gain.value?!0:!1}},{key:"getHRTF",value:function(t,e,i){var n=this.getNearestPoint(t,e,i),s=[];return s.iir_coeffs_left=n.iir_coeffs_left,s.iir_coeffs_right=n.iir_coeffs_right,s.itd=n.itd,s}},{key:"sphericalToCartesian",value:function(t,e,i){return{x:i*Math.sin(t),y:i*Math.cos(t),z:i*Math.sin(e)}}},{key:"getRealCoordinates",value:function(t,e,i){var n=this.getNearestPoint(t,e,i);return{azimuth:n.azimuth,elevation:n.elevation,distance:n.distance}}},{key:"getNearestPoint",value:function(t,e,i){var n=t*Math.PI/180,s=e*Math.PI/180,o=this.sphericalToCartesian(n,s,i),r=this.tree.nearest(o,1)[0];return r[0]}},{key:"HRTFDataset",set:function(t){this.hrtfDataset=t,this.hrtfDatasetLength=this.hrtfDataset.length;for(var e=0;e<this.hrtfDatasetLength;e++){var i=this.hrtfDataset[e],n=i.azimuth*Math.PI/180,s=i.elevation*Math.PI/180,r=this.sphericalToCartesian(n,s,i.distance);i.x=r.x,i.y=r.y,i.z=r.z}this.tree=o.createKdTree(this.hrtfDataset,this.distance,["x","y","z"]);var a=this.getHRTF(0,0,1);this.secondaryAudioGraph.setCoefficients(a.iir_coeffs_left,a.iir_coeffs_right),this.secondaryAudioGraph.setDelay(a.itd/1e3),this.mainAudioGraph.setCoefficients(a.iir_coeffs_left,a.iir_coeffs_right),this.mainAudioGraph.setDelay(a.itd/1e3)},get:function(){return this.hrtfDataset}}]),t}(),f=function(){function t(e){s(this,t),this.audioContext=e.audioContext,this.bufferSize=1024,this.input=this.audioContext.createGain(),this.gainNode=this.audioContext.createGain(),this.biquadFilterLeft=new r,this.biquadFilterRight=new r,this.fractionalDelayLeft=new a(44100),this.fractionalDelayRight=new a(44100),this.processorNode=this.audioContext.createScriptProcessor(this.bufferSize),this.input.connect(this.processorNode),this.processorNode.connect(this.gainNode),this.processorNodeFunction()}return n(t,[{key:"setCoefficients",value:function(t,e){this.biquadFilterLeft.setCoefficients(t),this.biquadFilterRight.setCoefficients(e)}},{key:"setDelay",value:function(t){var e=.001+t/2,i=.001-t/2;this.fractionalDelayLeft.setDelay(e),this.fractionalDelayRight.setDelay(i)}},{key:"processorNodeFunction",value:function(){var t=this;this.processorNode.onaudioprocess=function(e){var i=e.inputBuffer.getChannelData(0),n=e.outputBuffer.getChannelData(0),s=e.outputBuffer.getChannelData(1),o=new Float32Array(t.fractionalDelayLeft.process(i)),r=new Float32Array(t.fractionalDelayRight.process(i));t.biquadFilterLeft.process(o,n),t.biquadFilterRight.process(r,s)}}},{key:"connect",value:function(t){return this.gainNode.connect(t),this}},{key:"disconnect",value:function(t){return this.gainNode.disconnect(t),this}},{key:"gain",get:function(){return this.gainNode.gain}}]),t}();e.exports=h},{"babel-runtime/helpers/class-call-check":4,"babel-runtime/helpers/create-class":5,"biquad-filter":8,"fractional-delay":9,kdt:10}],3:[function(t,e,i){e.exports={"default":t("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":6}],4:[function(t,e,i){"use strict";i["default"]=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i.__esModule=!0},{}],5:[function(t,e,i){"use strict";var n=t("babel-runtime/core-js/object/define-property")["default"];i["default"]=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),n(t,s.key,s)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),i.__esModule=!0},{"babel-runtime/core-js/object/define-property":3}],6:[function(t,e,i){var n=t("../../modules/$");e.exports=function(t,e,i){return n.setDesc(t,e,i)}},{"../../modules/$":7}],7:[function(t,e,i){var n=Object;e.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},{}],8:[function(t,e,i){(function(n){!function(t){if("object"==typeof i&&"undefined"!=typeof e)e.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var s;"undefined"!=typeof window?s=window:"undefined"!=typeof n?s=n:"undefined"!=typeof self&&(s=self),s.BiquadFilter=t()}}(function(){return function e(i,n,s){function o(a,h){if(!n[a]){if(!i[a]){var f="function"==typeof t&&t;if(!h&&f)return f(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};i[a][0].call(c.exports,function(t){var e=i[a][1][t];return o(e?e:t)},c,c.exports,e,i,n,s)}return n[a].exports}for(var r="function"==typeof t&&t,a=0;a<s.length;a++)o(s[a]);return o}({1:[function(t,e,i){"use strict";var n=function(){return this.coefficients=[],this.memories=[],this.numberOfCascade=1,this.context=void 0,this.resetMemories(),this};$traceurRuntime.createClass(n,{setCoefficients:function(t){if(t){this.numberOfCascade=this.getNumberOfCascadeFilters(t),this.coefficients=[],this.coefficients.g=t[0];for(var e=0;e<this.numberOfCascade;e+=1)this.coefficients[e]={},this.coefficients[e].b1=t[1+4*e],this.coefficients[e].b2=t[2+4*e],this.coefficients[e].a1=t[3+4*e],this.coefficients[e].a2=t[4+4*e];return this.resetMemories(),!0}return console.error("No coefficients are set"),!1},getNumberOfCascadeFilters:function(t){var e=(t.length-1)/4;return e},resetMemories:function(){this.memories=[],this.memories[0]={},this.memories[0].xi1=0,this.memories[0].xi2=0,this.memories[0].yi1=0,this.memories[0].yi2=0;for(var t=1;t<this.numberOfCascade;t+=1)this.memories[t]={},this.memories[t].yi1=0,this.memories[t].yi2=0},process:function(t,e){for(var i,n,s,o,r,a,h,f,u,c,l,d=[],p=0;p<t.length;p+=1){i=t[p],n=this.coefficients[0].b1,s=this.coefficients[0].b2,o=this.coefficients[0].a1,r=this.coefficients[0].a2,a=this.memories[0].xi1,h=this.memories[0].xi2,f=this.memories[0].yi1,u=this.memories[0].yi2,d[0]=i+n*a+s*h-o*f-r*u;for(var m=1;m<this.numberOfCascade;m+=1)n=this.coefficients[m].b1,s=this.coefficients[m].b2,o=this.coefficients[m].a1,r=this.coefficients[m].a2,c=this.memories[m-1].yi1,l=this.memories[m-1].yi2,f=this.memories[m].yi1,u=this.memories[m].yi2,d[m]=d[m-1]+n*c+s*l-o*f-r*u;e[p]=d[this.numberOfCascade-1]*this.coefficients.g,this.memories[0].xi2=this.memories[0].xi1,this.memories[0].xi1=i;for(var y=0;y<this.numberOfCascade;y+=1)this.memories[y].yi2=this.memories[y].yi1,this.memories[y].yi1=d[y]}}},{}),e.exports=n},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(t,e,i){(function(n){!function(t){if("object"==typeof i&&"undefined"!=typeof e)e.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var s;"undefined"!=typeof window?s=window:"undefined"!=typeof n?s=n:"undefined"!=typeof self&&(s=self),s.FractionalDelay=t()}}(function(){return function e(i,n,s){function o(a,h){if(!n[a]){if(!i[a]){var f="function"==typeof t&&t;if(!h&&f)return f(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};i[a][0].call(c.exports,function(t){var e=i[a][1][t];return o(e?e:t)},c,c.exports,e,i,n,s)}return n[a].exports}for(var r="function"==typeof t&&t,a=0;a<s.length;a++)o(s[a]);return o}({1:[function(t,e,i){"use strict";var n=function(t,e){this.delayTime=0,this.posRead=0,this.posWrite=0,this.fracXi1=0,this.fracYi1=0,this.intDelay=0,this.fracDelay=0,this.a1=void 0,this.sampleRate=t,this.maxDelayTime=e||1,this.bufferSize=this.maxDelayTime*this.sampleRate,this.bufferSize%1!==0&&(this.bufferSize=parseInt(this.bufferSize)+1),this.buffer=new Float32Array(this.bufferSize)};$traceurRuntime.createClass(n,{setDelay:function(t){if(!(t<this.maxDelayTime))throw new Error("delayTime > maxDelayTime");this.delayTime=t;var e=t*this.sampleRate;this.intDelay=parseInt(e),this.fracDelay=e-this.intDelay,this.resample(),0!==this.fracDelay&&this.updateThiranCoefficient()},getDelay:function(){return this.delayTime},process:function(t){for(var e=new Float32Array(t.length),i=0;i<t.length;i+=1)this.buffer[this.posWrite]=t[i],e[i]=this.buffer[this.posRead],this.updatePointers();return 0===this.fracDelay?e:e=new Float32Array(this.fractionalThiranProcess(e))},updatePointers:function(){this.posWrite===this.buffer.length-1?this.posWrite=0:this.posWrite=this.posWrite+1,this.posRead===this.buffer.length-1?this.posRead=0:this.posRead=this.posRead+1},updateThiranCoefficient:function(){this.a1=(1-this.fracDelay)/(1+this.fracDelay)},resample:function(){if(this.posWrite-this.intDelay<0){var t=this.intDelay-this.posWrite;this.posRead=this.buffer.length-t}else this.posRead=this.posWrite-this.intDelay},fractionalThiranProcess:function(t){for(var e,i,n=new Float32Array(t.length),s=this.fracXi1,o=this.fracYi1,r=0;r<t.length;r+=1)e=t[r],i=this.a1*e+s-this.a1*o,s=e,o=i,n[r]=i;return this.fracXi1=s,this.fracYi1=o,n}},{}),e.exports=n},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(t,e,i){function n(t,e,i){this.obj=t,this.left=null,this.right=null,this.parent=i,this.dimension=e}function s(t,e,i){function s(t,e,o){var r,a,h=e%i.length;return 0===t.length?null:1===t.length?new n(t[0],h,o):(t.sort(function(t,e){return t[i[h]]-e[i[h]]}),r=Math.floor(t.length/2),a=new n(t[r],h,o),a.left=s(t.slice(0,r),e+1,a),a.right=s(t.slice(r+1),e+1,a),a)}var r=this;this.root=s(t,0,null),this.insert=function(t){function e(n,s){if(null===n)return s;var o=i[n.dimension];return t[o]<n.obj[o]?e(n.left,n):e(n.right,n)}var s,o,r=e(this.root,null);return null===r?void(this.root=new n(t,0,null)):(s=new n(t,(r.dimension+1)%i.length,r),o=i[r.dimension],void(t[o]<r.obj[o]?r.left=s:r.right=s))},this.remove=function(t){function e(n){if(null===n)return null;if(n.obj===t)return n;var s=i[n.dimension];return t[s]<n.obj[s]?e(n.left,n):e(n.right,n)}function n(t){function e(t,n){var s,o,r,a,h;return null===t?null:(s=i[n],t.dimension===n?null!==t.right?e(t.right,n):t:(o=t.obj[s],r=e(t.left,n),a=e(t.right,n),h=t,null!==r&&r.obj[s]>o&&(h=r),null!==a&&a.obj[s]>h.obj[s]&&(h=a),h))}function s(t,e){var n,o,r,a,h;return null===t?null:(n=i[e],t.dimension===e?null!==t.left?s(t.left,e):t:(o=t.obj[n],r=s(t.left,e),a=s(t.right,e),h=t,null!==r&&r.obj[n]<o&&(h=r),null!==a&&a.obj[n]<h.obj[n]&&(h=a),h))}var o,a,h;return null===t.left&&null===t.right?null===t.parent?void(r.root=null):(h=i[t.parent.dimension],void(t.obj[h]<t.parent.obj[h]?t.parent.left=null:t.parent.right=null)):(o=null!==t.left?e(t.left,t.dimension):s(t.right,t.dimension),a=o.obj,n(o),void(t.obj=a))}var s;s=e(r.root),null!==s&&n(s)},this.nearest=function(t,n,s){function a(s){function o(t,e){u.push([t,e]),u.size()>n&&u.pop()}var r,h,f,c,l=i[s.dimension],d=e(t,s.obj),p={};for(c=0;c<i.length;c+=1)c===s.dimension?p[i[c]]=t[i[c]]:p[i[c]]=s.obj[i[c]];return h=e(p,s.obj),null===s.right&&null===s.left?void((u.size()<n||d<u.peek()[1])&&o(s,d)):(r=null===s.right?s.left:null===s.left?s.right:t[l]<s.obj[l]?s.left:s.right,a(r),(u.size()<n||d<u.peek()[1])&&o(s,d),void((u.size()<n||Math.abs(h)<u.peek()[1])&&(f=r===s.left?s.right:s.left,null!==f&&a(f))))}var h,f,u;if(u=new o(function(t){return-t[1]}),s)for(h=0;n>h;h+=1)u.push([null,s]);for(a(r.root),f=[],h=0;n>h;h+=1)u.content[h][0]&&f.push([u.content[h][0].obj,u.content[h][1]]);return f},this.balanceFactor=function(){function t(e){return null===e?0:Math.max(t(e.left),t(e.right))+1}function e(t){return null===t?0:e(t.left)+e(t.right)+1}return t(r.root)/(Math.log(e(r.root))/Math.log(2))}}function o(t){this.content=[],this.scoreFunction=t}o.prototype={push:function(t){this.content.push(t),this.bubbleUp(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.sinkDown(0)),t},peek:function(){return this.content[0]},remove:function(t){for(var e=this.content.length,i=0;e>i;i++)if(this.content[i]==t){var n=this.content.pop();return void(i!=e-1&&(this.content[i]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.bubbleUp(i):this.sinkDown(i)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(t){for(var e=this.content[t];t>0;){var i=Math.floor((t+1)/2)-1,n=this.content[i];if(!(this.scoreFunction(e)<this.scoreFunction(n)))break;this.content[i]=e,this.content[t]=n,t=i}},sinkDown:function(t){for(var e=this.content.length,i=this.content[t],n=this.scoreFunction(i);;){var s=2*(t+1),o=s-1,r=null;if(e>o){var a=this.content[o],h=this.scoreFunction(a);n>h&&(r=o)}if(e>s){var f=this.content[s],u=this.scoreFunction(f);(null==r?n:h)>u&&(r=s)}if(null==r)break;this.content[t]=this.content[r],this.content[r]=i,t=r}}},e.exports={createKdTree:function(t,e,i){return new s(t,e,i)}}},{}]},{},[1]);